/* --------------------------------------------------------------------------
   Note
   --------------------------------------------------------------------------
   For one-off custom breakpoints, use modern range syntax:

   @media (width <= 640px) { ... }  // max-width
   @media (width >= 1280px) { ... } // min-width
   -------------------------------------------------------------------------- */

@use 'sass:map';
@use 'sass:list';

$breakpoints: (
  mobile: 0px,
  tablet: 768px,
  desktop: 1024px,
  wide: 1280px,
  ultrawide: 1536px,
);

/* --------------------------------------------------------------------------
   Core Logic Mixins
   -------------------------------------------------------------------------- */

// Min-width: Target $size and everything larger
@mixin breakpoint-up($size) {
  @if not map.has-key($breakpoints, $size) {
    @error "Breakpoint #{$size} not found. Available: #{map.keys($breakpoints)}";
  }

  $min-width: map.get($breakpoints, $size);

  @media (width >= $min-width) {
    @content;
  }
}

// Max-width: Target $size and everything smaller
@mixin breakpoint-down($size) {
  @if not map.has-key($breakpoints, $size) {
    @error "Breakpoint #{$size} not found. Available: #{map.keys($breakpoints)}";
  }

  $keys: map.keys($breakpoints);
  $index: list.index($keys, $size);

  @if $index < list.length($keys) {
    $next-size: list.nth($keys, $index + 1);
    $next-min: map.get($breakpoints, $next-size);

    @media (width < $next-min) {
      @content;
    }
  } @else {
    @content;
  }
}

@mixin breakpoint-between($lower, $upper) {
  @if not map.has-key($breakpoints, $lower) or not map.has-key($breakpoints, $upper) {
    @error "Breakpoint range [#{$lower}, #{$upper}] contains a key that does not exist. Available: #{map.keys($breakpoints)}";
  }

  $keys: map.keys($breakpoints);
  $lower-index: list.index($keys, $lower);
  $upper-index: list.index($keys, $upper);

  @if $lower-index > $upper-index {
    @error "Invalid breakpoint range: '#{$lower}' comes after '#{$upper}'. " + "Ensure your lower bound is smaller than your upper bound.";
  }

  $min-width: map.get($breakpoints, $lower);

  @if $upper-index < list.length($keys) {
    $next-size: list.nth($keys, $upper-index + 1);
    $next-min: map.get($breakpoints, $next-size);

    @media (width >= $min-width) and (width < $next-min) {
      @content;
    }
  } @else {
    @media (width >= $min-width) {
      @content;
    }
  }
}

/* --------------------------------------------------------------------------
   Semantic Helpers
   -------------------------------------------------------------------------- */

@mixin mobile {
  @include breakpoint-between(mobile, mobile) {
    @content;
  } // < 768px
}

@mixin tablet {
  @include breakpoint-between(tablet, tablet) {
    @content;
  } // 768px – < 1024px
}

@mixin mobile-and-tablet {
  @include breakpoint-down(tablet) {
    @content;
  } // < 1024px
}

@mixin desktop-and-up {
  @include breakpoint-up(desktop) {
    @content;
  } // ≥ 1024px
}

@mixin wide-and-up {
  @include breakpoint-up(wide) {
    @content;
  } // ≥ 1280px
}

@mixin ultrawide {
  @include breakpoint-up(ultrawide) {
    @content;
  } // ≥ 1536px
}

// Specific ranges
@mixin desktop {
  @include breakpoint-between(desktop, desktop) {
    @content;
  }
}

@mixin desktop-and-wide {
  @include breakpoint-between(desktop, wide) {
    @content;
  }
}

/* --------------------------------------------------------------------------
   Interaction & Capability Helpers
   -------------------------------------------------------------------------- */

/**
 * Targets devices with a mouse/trackpad (fine pointer) that support hover.
 * Essential for 1024px screens (iPad landscape vs small Laptops).
 */
@mixin has-hover {
  @media (hover: hover) and (pointer: fine) {
    @content;
  }
}

/* Targets touch-first devices (coarse pointer) */
@mixin is-touch {
  @media (pointer: coarse) {
    @content;
  }
}
